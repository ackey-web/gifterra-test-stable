# GIFTERRAプラットフォーム戦略

## 概要

GIFTERRAは**1つのコードベース**で3つのプラットフォームに対応します：

1. **PCブラウザ** - 完全機能版（送受信 + テナント管理）
2. **スマホブラウザ** - 送受信のみ
3. **スマホアプリ（iOS/Android）** - 送受信のみ（初期）→ 将来的に簡易管理機能追加

## プラットフォーム別機能マトリックス

### フェーズ1：初期リリース（現在）

| 機能 | PCブラウザ | スマホブラウザ | スマホアプリ |
|------|-----------|---------------|-------------|
| **送金（シンプル/テナントチップ/一括）** | ✅ | ✅ | ✅ |
| **受取確認** | ✅ | ✅ | ✅ |
| **QRスキャン** | 手動入力のみ | 手動入力のみ | 🔜 カメラ |
| **kodomi確認** | ✅ | ✅ | ✅ |
| **テナント管理画面** | ✅ 完全版 | ❌ | ❌ |
| **商品管理** | ✅ | ❌ | ❌ |
| **統計・分析** | ✅ | ❌ | ❌ |

### フェーズ2：アプリ版リリース（1-2ヶ月後）

| 機能 | PCブラウザ | スマホブラウザ | スマホアプリ |
|------|-----------|---------------|-------------|
| **送金（シンプル/テナントチップ/一括）** | ✅ | ✅ | ✅ |
| **受取確認** | ✅ | ✅ | ✅ |
| **QRスキャン** | 手動入力のみ | 手動入力のみ | ✅ カメラ |
| **kodomi確認** | ✅ | ✅ | ✅ |
| **テナント管理画面** | ✅ 完全版 | ❌ | ❌ |
| **商品管理** | ✅ | ❌ | ❌ |
| **統計・分析** | ✅ | ❌ | ❌ |

### フェーズ3：スマホ管理機能追加（3-6ヶ月後）

| 機能 | PCブラウザ | スマホブラウザ | スマホアプリ |
|------|-----------|---------------|-------------|
| **送金（シンプル/テナントチップ/一括）** | ✅ | ✅ | ✅ |
| **受取確認** | ✅ | ✅ | ✅ |
| **QRスキャン** | 手動入力のみ | 手動入力のみ | ✅ カメラ |
| **kodomi確認** | ✅ | ✅ | ✅ |
| **テナント管理画面** | ✅ 完全版 | ❌ | ✅ 簡易版 |
| **商品管理** | ✅ 完全版 | ❌ | ✅ 簡易版 |
| **統計・分析** | ✅ 完全版 | ❌ | ✅ 基本統計 |

## 技術的実装方法

### プラットフォーム検出

```typescript
import { Capacitor } from '@capacitor/core';

// ネイティブアプリかどうか
const isNative = Capacitor.isNativePlatform();

// モバイルデバイスかどうか
const isMobile = window.innerWidth < 768;

// プラットフォーム判定
if (!isMobile && !isNative) {
  // PCブラウザ
} else if (isMobile && !isNative) {
  // スマホブラウザ
} else if (isNative) {
  // スマホアプリ
}
```

### 機能分岐の実装例

```typescript
// src/pages/Mypage.tsx

export function MypagePage() {
  const isNative = Capacitor.isNativePlatform();
  const isMobile = window.innerWidth < 768;
  const [tenantRank, setTenantRank] = useState<TenantRank>('R0');

  return (
    <div>
      {/* 送受信パネル（全プラットフォーム共通） */}
      <SendReceivePanel />

      {/* テナント機能（プラットフォーム別） */}
      {tenantRank === 'R3' && (
        <>
          {/* PCブラウザ: 完全版テナント管理 */}
          {!isMobile && !isNative && (
            <FullTenantDashboard />
          )}

          {/* スマホブラウザ: 閲覧のみ + PC誘導 */}
          {isMobile && !isNative && (
            <div style={{
              padding: 16,
              background: 'rgba(118, 75, 162, 0.1)',
              borderRadius: 12,
              textAlign: 'center',
            }}>
              <div style={{ fontSize: 14, opacity: 0.7 }}>
                💡 テナント管理機能はPCブラウザでご利用ください
              </div>
              <div style={{ fontSize: 12, opacity: 0.5, marginTop: 8 }}>
                gifterra.app/admin
              </div>
            </div>
          )}

          {/* スマホアプリ: フェーズ3で簡易管理追加予定 */}
          {isNative && (
            <SimpleTenantView
              showComingSoon={true}
              message="簡易管理機能は今後のアップデートで追加予定"
            />
          )}
        </>
      )}
    </div>
  );
}
```

## ビルド・デプロイ方法

### Webブラウザ版（PCとスマホ両方）

```bash
# 開発
pnpm dev
# → http://localhost:5173

# 本番ビルド
pnpm build
# → dist/フォルダ

# デプロイ
# Vercel、Netlify、またはホスティングサービスへ
```

### スマホアプリ版（iOS/Android）

```bash
# 1. Webアセットをビルド
pnpm build

# 2. ネイティブプロジェクトに同期
npx cap sync

# 3. iOS: Xcodeで開く
npx cap open ios
# → App/App.xcworkspaceで開く
# → シミュレータまたは実機で実行

# 4. Android: Android Studioで開く
npx cap open android
# → Gradle同期後、エミュレータまたは実機で実行
```

## リリース戦略

### ステップ1：Webブラウザ版リリース（今すぐ）

**対象:**
- PCブラウザ → 完全機能
- スマホブラウザ → 送受信のみ

**目的:**
- ユーザーフィードバック収集
- バグ修正
- 使用パターンの分析

**期間:** 1-2ヶ月

---

### ステップ2：スマホアプリ初期版リリース

**対象:**
- iOS/Android アプリストア

**機能:**
- 送受信のみ（Web版と同じ）
- QRスキャナー有効化

**目的:**
- アプリストアでの露出
- プッシュ通知の準備（実装は後）
- カメラスキャン体験の提供

**審査:**
- App Store: $99/年
- Google Play: $25（一度だけ）

**期間:** 2-3週間（審査含む）

---

### ステップ3：スマホ管理機能追加

**対象:**
- スマホアプリのアップデート

**追加機能:**
- 簡易テナント管理
  - チップ受取履歴
  - 今日/今週の統計
  - 商品の簡易追加・編集
  - kodomi履歴

**目的:**
- スマホだけで完結できる体験
- テナントユーザーの満足度向上

**開発期間:** 2-3週間

## ユーザー導線設計

### 一般ユーザー（非テナント）

```
スマホアプリをダウンロード
↓
ウォレット接続
↓
送金・受取を利用
↓
（終了）
```

### テナントユーザー（R3）

**フェーズ1（現在）:**
```
PCブラウザでテナント登録・管理
↓
スマホアプリでチップ受取
↓
PCブラウザで統計確認・商品管理
```

**フェーズ3（将来）:**
```
PCブラウザでテナント登録
↓
スマホアプリでチップ受取
↓
スマホアプリで簡易管理
↓
詳細分析はPCブラウザ
```

## よくある質問

### Q1: なぜスマホブラウザとアプリで機能が違うの？

A: スマホブラウザは誰でもアクセスできるため、軽量な送受信機能のみに絞っています。アプリ版はインストールしたユーザー向けに、QRスキャンなどの追加機能を提供します。

### Q2: テナント管理をPCだけにする理由は？

A: 商品管理や詳細な統計分析は、大画面のPCの方が作業しやすいためです。スマホアプリには将来的に「よく使う機能」だけを追加予定です。

### Q3: 同じコードで3つのプラットフォームに対応できるの？

A: はい。Capacitorを使用しており、`Capacitor.isNativePlatform()`でプラットフォームを判定して機能を分岐できます。

### Q4: PWAじゃダメなの？

A: PWAも選択肢ですが、QRスキャンの体験がネイティブアプリより劣ります。また、App Storeでの露出も重要な要素です。

### Q5: Web版とアプリ版でデータは同期される？

A: はい。両方とも同じウォレットアドレスでログインするため、データは完全に同期されます。

## 開発ロードマップ

### Q1 2025（完了）
- ✅ PCブラウザ版開発
- ✅ Capacitorセットアップ
- ✅ QRスキャナー実装

### Q2 2025
- [ ] Webブラウザ版リリース
- [ ] ユーザーフィードバック収集
- [ ] バグ修正
- [ ] スマホアプリ最終調整

### Q3 2025
- [ ] App Store / Google Play申請
- [ ] スマホアプリ初期版リリース
- [ ] プッシュ通知機能開発

### Q4 2025
- [ ] スマホ簡易管理機能開発
- [ ] アプリアップデート
- [ ] メインネット移行準備

---

**最終更新**: 2025-10-30
**バージョン**: GIFTERRA v1.0
**プロジェクト**: GIFTERRA by METATRON
